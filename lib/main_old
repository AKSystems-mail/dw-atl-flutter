import 'dart:math';
import 'package:flutter/material.dart';

void main() {
  runApp(const DopeWarsAtlanta());
}

class Location {
  final String name;  
  final String description;

  Location({
    required this.name,    
    required this.description,
  });
}

class Product {
  final String name;
  final double price;

  Product({required this.name, required this.price});
}

final List<Product> allProducts = [
  Product(name: 'Weed', price: 100.0),
  Product(name: 'Cocaine', price: 500.0),
  Product(name: 'Heroin', price: 1000.0),
  Product(name: 'LSD', price: 200.0),
  Product(name: 'MDMA', price: 300.0),
];

class DopeWarsAtlanta extends StatelessWidget {
  const DopeWarsAtlanta({super.key});

  @override
  Widget build(BuildContext context) {
    return MaterialApp(
      title: 'Dope Wars Atlanta',
      theme: ThemeData(
        primarySwatch: Colors.blue,
      ),
      home: GameHomePage(),
    );
  }
}

class GameHomePage extends StatefulWidget {
  final List<Location> locations = [
    // ... (your existing locations)

    Location(
      name: 'Midtown',      
      description: 'Fox Theater and that rainbow crosswalk',
    ),
    Location(
        name: 'Buckhead',       
        description: 'Old money and highrises'),
    Location(
      name: 'Cobb County',      
      description: 'Technically ITP so don"t stay here long',
    ),
    Location(
      name: 'Little Five Points',
      imagePath: 'assets/images/little_five_points.jpg',
      description: 'Hipters everywhere. Only place to buy bigger bookbags',
    ),
    Location(
      name: 'Decatur',
      imagePath: 'assets/images/decatur.jpg',
      description: 'It"s the souf side obviously',
    ),
    Location(
      name: 'West End',
      imagePath: 'assets/images/west_end.jpg',
      description: 'Thriller without the music and dancing',
    ),
  ];

  GameHomePage({super.key});

  @override
  State<GameHomePage> createState() => _GameHomePageState();
}

class _GameHomePageState extends State<GameHomePage> {
  late Map<Location, List<Product>> locationProducts;
  late Location selectedLocation;

  @override
  void initState() {
    super.initState();
    locationProducts = {};
    _assignProductsToLocations();
    selectedLocation = widget.locations[0];
  }

  void _assignProductsToLocations() {
    for (var location in widget.locations) {
      locationProducts[location] = [];
      for (var product in allProducts) {
        if (Random().nextInt(2) == 0) {
          locationProducts[location]!.add(product);
        }
      }
    }
  }

  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: const Text('Dope Wars Atlanta'),
      ),
      body: Center(
        child: ListView.builder(
          itemCount: widget.locations.length,
          itemBuilder: (context, index) {
            final location = widget.locations[index];
            return GestureDetector(
              onTap: () {
                setState(() {
                  selectedLocation = location;
                });
              },
              child: Card(
                child: Column(
                  children: [
                    Image.asset(
                      location.imagePath,
                      height: 200,
                    ),
                    Text(location.name,
                        style: TextStyle(
                            fontSize: 24, fontWeight: FontWeight.bold)),
                    Text(location.description),
                    if (selectedLocation == location) ...[
                      SizedBox(
                        height: 20,
                      ),
                      ...locationProducts[selectedLocation]!
                          .map((product) => Text(
                              '${product.name}: \$${product.price.toStringAsFixed(2)}'))
                          .toList(),
                    ],
                  ],
                ),
              ),
            );
          },
        ),
      ),
    );
  }
}
